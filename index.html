<!DOCTYPE html>
<html lang="eÐ¸">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D.C.O Documentary</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js" integrity="sha512-n/4gHW3atM3QqRcbCn6ewmpxcLAHGaDjpEBu4xZd47N0W2oQ+6q7oc3PXstrJYXcbNU1OHdQ1T7pAP+gi5Yu8g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <div class="container">
        <div class="containerMain">
            <header class="header">
                <div class="headerContent">
                    <div class="logo">logo place<wbr>holder</div>
                    <div class="searchBar">
                        <form class="searchForm" action="" method="get">
                            <input type="text" class="searchInput" placeholder="Search" oninput="checkInput(this)">
                            <button type="submit" class="searchButton" disabled>Search</button>
                            <div class="searchTip"></div>
                        </form>
                    </div>
                    <div class="langContainer">
                        <div class="langImgContainer">
                            <img src="https://upload.wikimedia.org/wikipedia/en/thumb/1/12/Flag_of_Poland.svg/1200px-Flag_of_Poland.svg.png" alt="" id="langImg">
                        </div>
                        <label for="lang">Language
                        <select name="lang" id="lang" onchange="changeLang(this)">
                            <option value="Polish">Polish</option>
                            <option value="English">English</option>
                            <option value="Mandarin">Mandarin</option>
                            <option value="Spanish">Spanish</option>
                        </select>
                        </label>
                    </div>
                </div>
                <div class="smallNav"></div>
            </header>
            <div class="navBar rounded">
                <h3>Heading</h3>
                <ul>
                    <li><a href="#">test1</a></li>
                    <li><a href="#">test1</a></li>
                    <li><a href="#">test1</a></li>
                </ul>
                <h3>Heading2</h3>
                <ul>
                    <li><a href="#">test1</a></li>
                    <li><a href="#">test1</a></li>
                    <li><a href="#">test1</a></li>
                </ul>
                <h3>Heading3</h3>
                <ul>
                    <li><a href="#">test1</a></li>
                    <li><a href="#">test1</a></li>
                    <li><a href="#">test1</a></li>
                </ul>
                <h3>Heading4</h3>
                <ul>
                    <li><a href="#">test1eeeeeeeeee</a></li>
                    <li><a href="#">test1</a></li>
                    <li><a href="#">test1</a></li>
                </ul>
            </div>
            <div class="main rounded"></div>
            <footer class="footer">
                <a href="https://github.com/Radziu47/Asperia">My project on GitHub</a>
                <a href="https://github.com/NukieGIT">My friend's GitHub</a>
                <a href="https://nukiegit.github.io/rock-paper-scissors/">RPS</a>
            </footer>
        </div>
    </div>
</body>

</html>
<script>

    let currentLang = "pl"
    let currentElement

    const searchForm = document.querySelector(".searchForm")
    const searchInput = document.querySelector(".searchInput")
    const searchTip = document.querySelector(".searchTip")

    // searchForm.addEventListener("submit", e => {
    //     e.preventDefault()
    //     database($(".searchInput").val())
    // })

    searchInput.addEventListener("input", e => {
        if (e.target.value.length >= 1 && e.target.value != "null") {
            database(e.target.value)
        }else{
            searchTip.textContent = ""
        }
    })

    document.addEventListener("mousedown", e => {
        currentElement = e.target.classList.value
    })

    searchInput.addEventListener("focus", e => {
        searchTip.classList.add("show")
    })
    searchInput.addEventListener("blur", e => {
        if (!currentElement.includes("searchResults")) {
            searchTip.classList.remove("show")
        }
    })

    async function database(name) {

        searchTip.textContent = ""

        const response = await fetch(`./Databases/demon_${currentLang}.json`)

        const data = await response.json()

        const dataSearch = await data[2].data

        const nameFound = await dataSearch.forEach((element, key) => {
            if (name.includes(element.Code)) {
                if (dataSearch[key].Code.includes(name)) {
                    const element = document.createElement("p")
                    element.textContent = dataSearch[key].Nazwa
                    element.classList.add("searchResults")
                    searchTip.append(element)
                    element.addEventListener("click", e => {
                        searchInput.value = element.textContent
                        database(searchInput.value)
                    })
                }
            }else if (element.Code == null) {
                if (dataSearch[key].Nazwa.toLowerCase().includes(name.toLowerCase())) {
                    const element = document.createElement("p")
                    element.textContent = dataSearch[key].Nazwa
                    element.classList.add("searchResults")
                    searchTip.append(element)
                    element.addEventListener("click", e => {
                        searchInput.value = element.textContent
                        database(searchInput.value)
                    })
                }
            }
        })
        }


    function checkInput(thisElement) {
    if(thisElement.value !== null && thisElement.value !== ""){
        $(".searchButton").prop("disabled", false);
    }else{
        $(".searchButton").prop("disabled", true);
    }
}

// function changeLang(thisElement) {
//     if (thisElement.value == "Polish") {
//         $("#langImg").attr("src", "https://preview.redd.it/3ptjjx7k8jy51.png?width=440&format=png&auto=webp&s=a219b729ae0512f6f0eccf57211a3e9bac07130b")
//     }else if (thisElement.value == "English") {
//         $("#langImg").attr("src", "https://learnenglishteens.britishcouncil.org/sites/teens/files/styles/article/public/istock_000020059921small_0_0_1.jpg?itok=Bs-akrAV")
//     }else if (thisElement.value == "Mandarin") {
//         $("#langImg").attr("src", "https://produits.bienmanger.com/34091-0w0h0_Organic_Fresh_Mandarin.jpg")
//     }else if (thisElement.value == "Spanish") {
//         $("#langImg").attr("src", "https://m.media-amazon.com/images/I/61FDjsfnkML._AC_UX385_.jpg")        
//     }
// }

function changeLang(thisElement) {
    if (thisElement.value == "Polish") {
        currentLang = "pl"
        $("#langImg").attr("src", "https://upload.wikimedia.org/wikipedia/en/thumb/1/12/Flag_of_Poland.svg/1200px-Flag_of_Poland.svg.png")
    }else if (thisElement.value == "English") {
        currentLang = "eng"
        $("#langImg").attr("src", "https://upload.wikimedia.org/wikipedia/en/thumb/a/ae/Flag_of_the_United_Kingdom.svg/1200px-Flag_of_the_United_Kingdom.svg.png")
    }else if (thisElement.value == "Mandarin") {
        currentLang = "zh"
        $("#langImg").attr("src", "https://cdn.britannica.com/90/7490-004-BAD4AA72/Flag-China.jpg")
    }else if (thisElement.value == "Spanish") {
        currentLang = "sp"
        $("#langImg").attr("src", "https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Flag_of_Spain.svg/2560px-Flag_of_Spain.svg.png")        
    }
}


</script>
